% Code Written by Seth Koenig 9/1/2015
% code automatically runs all analysis for SCMRM the Scene Manipulation
% task for the relational memory project
clear,clc


%---To Pre-lesion---%
% cortex_files = {'TO150901.2','TO150903.2','TO150904.3',...
%                 'TO150908.2','TO150909.2','TO150910.2','TO150911.2',...
%                 'TO150914.2','TO150915.2','TO150916.2','TO150918.2',...
%                 'TO151001.2','TO151002.2','TO151006.2','TO151007.2'};
% item_files = {'SCMRM01.itm','SCMRM03.itm','SCMRM04.itm',...
%               'SCMRM05.itm','SCMRM06.itm','SCMRM07.itm','SCMRM08.itm',...
%               'SCMRM09.itm','SCMRM10.itm','SCMRM11.itm','SCMRM12.itm',...
%               'SCMRM13.itm','SCMRM14.itm','SCMRM15.itm','SCMRM16.itm'};

%---To Post-lesion---%
% cortex_files = {'TO170620.2','TO170621.2','TO170622.2','TO170623.2',...
%     'TO170626.2','TO170627.2','TO170628.2','TO170629.2',...
%     'TO170630.2','TO170705.2','TO170706.2','TO170707.2',...
%     'TO170710.2','TO170711.2','TO170712.2'};
% item_files = {'SCMRM21.itm','SCMRM22.itm','SCMRM23.itm','SCMRM24.itm',...
%     'SCMRM25.itm','SCMRM26.itm','SCMRM27.itm','SCMRM28.itm',...
%     'SCMRM29.itm','SCMRM30.itm','SCMRM31.itm','SCMRM32.itm',...
%     'SCMRM33.itm','SCMRM34.itm','SCMRM35.itm'};


%---RR Pre-Lesion---%
% cortex_files = {'RR151027.2','RR151026.2','RR151023.2','RR151022.2',...
%                 'RR151021.2','RR151020.2','RR151019.2','RR151016.2',...
%                 'RR151015.3','RR151014.2','RR151013.2','RR151009.2',...
%                 'RR151008.2','RR151007.2','RR151005.2','RR151002.2',...
%                 'RR151001.2'};
% item_files =   {'SCMRM20.itm','SCMRM19.itm','SCMRM18.itm','SCMRM17.itm',...
%                 'SCMRM16.itm','SCMRM15.itm','SCMRM14.itm','SCMRM13.itm',...
%                 'SCMRM12.itm','SCMRM11.itm','SCMRM10.itm','SCMRM09.itm',...
%                 'SCMRM08.itm','SCMRM07.itm','SCMRM06.itm','SCMRM05.itm',...
%                 'SCMRM04.itm'};

%---RR Post-Lesion---%
% cortex_files = {'RR160425.2','RR160426.2','RR160701.2','RR160706.2','RR160707.2',...
%                 'RR160708.2','RR160714.2','RR160715.2','RR160718.2','RR160721.2',...
%                 'RR160725.2','RR160726.2','RR160727.2','RR160728.2','RR160729.2',...
%                 'RR160801.2','RR160803.2','RR160804.2','RR160805.2'};
% item_files = {'SCMRM21.itm','SCMRM22.itm','SCMRM23.itm','SCMRM24.itm','SCMRM25.itm',...
%               'SCMRM26.itm','SCMRM27.itm','SCMRM28.itm','SCMRM29.itm','SCMRM30.itm',...
%               'SCMRM31.itm','SCMRM32.itm','SCMRM33.itm','SCMRM34.itm','SCMRM35.itm',...
%               'SCMRM36.itm','SCMRM37.itm','SCMRM38.itm','SCMRM39.itm'};

%---PW pre-lesion---%
%calibration high/off during 'PW150909.2' (SCMRM26.itm) so removed from analysis
% cortex_files = {'PW150901.2','PW150902.2','PW150903.2','PW150904.2',...
%                 'PW150908.2','PW150910.2','PW150911.2',...
%                 'PW150914.2','PW150916.2','PW150917.2','PW150918.2',...
%                 'PW150921.2','PW150922.2','PW150923.2','PW150924.2'};
%             %test change
%
% item_files = {'SCMRM21.itm','SCMRM22.itm','SCMRM23.itm','SCMRM24.itm',...
%               'SCMRM25.itm','SCMRM27.itm','SCMRM28.itm',...
%               'SCMRM29.itm','SCMRM30.itm','SCMRM31.itm','SCMRM32.itm',...
%               'SCMRM33.itm','SCMRM34.itm','SCMRM35.itm','SCMRM36.itm'};

%---PW post-lesion---%
% cortex_files = {'PW160401.2','PW160405.2','PW160406.2','PW160407.2','PW160408.2',...
%                 'PW160411.2','PW160412.2','PW160413.2','PW160414.2','PW160415.2',...
%                 'PW160418.2','PW160419.2','PW160420.2','PW160421.2','PW160422.2'};
%
% item_files = {'SCMRM02.itm','SCMRM03.itm','SCMRM04.itm','SCMRM05.itm','SCMRM06.itm',...
%               'SCMRM07.itm','SCMRM08.itm','SCMRM09.itm','SCMRM10.itm','SCMRM11.itm'...
%               'SCMRM12.itm','SCMRM13.itm','SCMRM14.itm','SCMRM15.itm','SCMRM16.itm'};

% cortex_files = {'TT150901.2','TT150902.2','TT150903.2','TT150904.2',...
%                 'TT150908.2','TT150909.2','TT150910.2','TT150911.2',...
%                 'TT150914.2','TT150915.2','TT150916.2','TT150917.2',...
%                 'TT150921.2','TT150922.2','TT150923.2'};
% item_files = {'SCMRM01.itm','SCMRM02.itm','SCMRM03.itm','SCMRM04.itm',...
%               'SCMRM05.itm','SCMRM06.itm','SCMRM07.itm','SCMRM08.itm',...
%               'SCMRM09.itm','SCMRM10.itm','SCMRM11.itm','SCMRM12.itm',...
%               'SCMRM13.itm','SCMRM14.itm','SCMRM15.itm'};


%---Manfred Pre-lesion---%
% before added 5 dva fixation window on clr change may not be as accuracte
% of a calibration as necessary. Would want to manually check
% cortex_files = {'MF170214.3','MF170215.2','MF170217.2','MF170221.2'};
% item_files = {'SCMRM21.itm','SCMRM22.itm','SCMRM23.itm','SCMRM24.itm'};
%
% after added 5  dva fixation window on clr change trials
% cortex_files = {'MF170222.2','MF170223.2','MF170224.2','MF170227.2',...
%                 'MF170301.2','MF170303.2','MF170306.2','MF170307.2',...
%                 'MF170308.2','MF170309.2','MF170313.2','MF170314.2',...
%                 'MF170315.2','MF170316.2','MF170317.2'};
% item_files = {'SCMRM25.itm','SCMRM26.itm','SCMRM27.itm','SCMRM28.itm',...
%               'SCMRM29.itm','SCMRM31.itm','SCMRM32.itm','SCMRM33.itm',...
%               'SCMRM34.itm','SCMRM35.itm','SCMRM36.itm','SCMRM37.itm',...
%               'SCMRM38.itm','SCMRM39.itm','SCMRM40.itm'};

%---Manfred Post-Lesion
cortex_files = {'MF180524.2','MF180525.2','MF180529.2','MF180530.2',...
                'MF180531.2','MF180601.2'};%,'MF180604.2'};
item_files = {'SCMRM02.itm','SCMRM03.itm','SCMRM04.itm',...
              'SCMRM05.itm','SCMRM06.itm','SCMRM07.itm','SCMRM08.itm',...
              'SCMRM09.itm','SCMRM10.itm','SCMRM11.itm','SCMRM12.itm',...
              'SCMRM13.itm','SCMRM14.itm','SCMRM15.itm'};

%all files
% cortex_files = {'All','TO150901.2','TO150902.2','TO150903.2','TO150904.3',...
%     'TO150908.2','TO150909.2','TO150910.2','TO150911.2',...
%     'TO150915.2','TO150916.2','TO150918.2',...
%     'TO151001.2','TO151002.2','TO151006.2','TO151007.2',...
%     'PW150901.2','PW150902.2','PW150903.2','PW150904.2',...
%     'PW150908.2','PW150910.2','PW150911.2',...
%     'PW150914.2','PW150916.2','PW150917.2','PW150918.2',...
%     'PW150921.2','PW150922.2','PW150923.2','PW150924.2',...
%     'RR151027.2','RR151026.2','RR151023.2','RR151022.2',...
%     'RR151021.2','RR151020.2','RR151019.2','RR151016.2',...
%     'RR151015.3','RR151014.2','RR151013.2','RR151009.2',...
%     'RR151008.2','RR151007.2','RR151005.2','RR151002.2',...
%     'RR151001.2','MF170222.2','MF170223.2','MF170224.2','MF170227.2',...
%     'MF170301.2','MF170303.2','MF170306.2','MF170307.2',...
%     'MF170308.2','MF170309.2','MF170313.2','MF170314.2',...
%     'MF170315.2','MF170316.2','MF170317.2'};


fixwin = 3.5; %size of the fixation window/2. Width of fixwin is 7 dva
imageX = 800;
imageY = 600;

data_dir = 'C:\Users\seth.koenig\Documents\MATLAB\SCM_RelationalMemory\Eye Data\';%location of processed eye data
ROI_dir = 'C:\Users\seth.koenig\Documents\MATLAB\SCM_RelationalMemory\'; %locations of regions of interest
figure_dir = 'C:\Users\seth.koenig\Documents\MATLAB\SCM_RelationalMemory\Figures\'; %where to put plots
img_dir = 'C:\Users\seth.koenig\Documents\MATLAB\SCM_RelationalMemory\Image Sets\'; %where all the image sets are

%
% %%---Preprocess all the ListRM data---%%%
% for file = 1:length(cortex_files)
%     ImportSCMRMData(cortex_files{file},item_files{file},figure_dir,data_dir);
% end

%
% %---Determine Amount of Time/# of Fixations in ROI---%%%
set(0,'DefaultFigureVisible','OFF');
for file =1:length(cortex_files)
    SCMRM_ROIanalysis(cortex_files{file},item_files{file},figure_dir,data_dir,ROI_dir,img_dir);
end
set(0,'DefaultFigureVisible','On');
%%
% %%
% %%%---Combined Data across sets---%%%
CombineSCMRM_ROIdata(cortex_files,data_dir,figure_dir)
%%
% %%%---Determine Fixation Durations, Saccade Amplitudes, Pupil Diameter Across Multiple Sets---%
combinedEyeMovementStats_SCMRM(data_dir,cortex_files)
%%
% Pupil correlated with behavior
combinedPupilROI_SCMRM(data_dir,cortex_files,ROI_dir)